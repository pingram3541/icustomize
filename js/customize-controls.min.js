!function(e,t){var i;i={queriedPost:new t.Value};var s='<div id="customize-resizer"><div class="control-pane"><div class="control-editor-item editor-width" title="Editor Panel Custom Width"><div class="control-editor-spacer"></div><i class="fa fa-caret-square-o-left editor"></i><div class="control-input-slide"><span class="control-input-title">Editor Custom Width (px):</span><input type="number" /></div></div></div><div class="resize-pane"><div class="control-editor-item preview-width" title="Preview Panel Custom Width"><div class="control-editor-spacer"></div><i class="fa fa-caret-square-o-right preview"></i><div class="control-input-slide"><span class="control-input-title">Preview Custom Width (px):</span><input type="number" /></div></div><div class="control-editor-item preview-desktop" title="Full > 1240px"><i class="fa fa-desktop"></i></div><div class="control-editor-item preview-laptop" title="Laptop < 1240px"><i class="fa fa-laptop"></i></div><div class="control-editor-item preview-tablet" title="Tablet < 768px"><i class="fa fa-tablet"></i></div><div class="control-editor-item preview-mobile" title="Mobile < 480px"><i class="fa fa-mobile"></i></div></div></div>',o=function(){var e=0;return function(t,i){clearTimeout(e),e=setTimeout(t,i)}}();t.bind("ready",function(){t.previewer.bind("queried-post",function(e){i.queriedPost.set(e||!1)})}),i.queriedPost.bind(function(t,i){var s=e("body [id^=customize-control-icustomize-page-css] .customize-control-title"),o=e("body [id^=customize-control-icustomize-page-js] .customize-control-title"),a=e("body [id^=customize-control-icustomize-page-css] .customize-control-description"),r=e("body [id^=customize-control-icustomize-page-js] .customize-control-description"),c=e("body [id^=customize-control-icustomize-page-css] .CodeMirror"),n=e("body [id^=customize-control-icustomize-page-js] .CodeMirror"),d=c[0].CodeMirror,m=n[0].CodeMirror;if(t){console.log(t),window.pid=t.ID.toString(),window.meta=t.meta,window.theme=t.theme;var l=e("#customize-preview iframe").contents().find("#icustomize-page-css-"+window.theme),p=e("#customize-preview iframe").contents().find("#icustomize-page-js-"+window.theme),u="",w="";u=l.html(),u?(d.setValue(u.replace(/^\s+|\s+$/g,"")),c.hasClass("hidden")&&(_css_title.text("Custom Page CSS"),post_css_description.text("Edit the page's custom css.").attr("style",""),c.removeClass("hidden"),d.refresh())):(d.setValue(""),l.length||e("#customize-preview iframe").contents().find("head").append('<style id="icustomize-page-css-'+window.theme+'">'),c.hasClass("hidden")&&(s.text("Custom Page CSS"),a.text("Edit the page's custom css.").attr("style",""),c.removeClass("hidden"),d.refresh())),w=p.html(),w?(m.setValue(w.replace(/^\s+|\s+$/g,"")),n.hasClass("hidden")&&(o.text("Custom Page JS"),r.text("Edit the page's custom js.").attr("style",""),n.removeClass("hidden"),m.refresh())):(m.setValue(""),p.length||e("#customize-preview iframe").contents().find("body").append('<script id="icustomize-page-js-'+window.theme+'">'),n.hasClass("hidden")&&(o.text("Custom Page JS"),r.text("Edit the page's custom js.").attr("style",""),n.removeClass("hidden"),m.refresh()))}else s.text("Custom Page CSS: ERROR"),a.text("Sorry, this is not a singular post/page template and therefore cannot store custom css, use master css instead.").attr("style","color: red;"),c.addClass("hidden"),o.text("Custom Page JS: ERROR"),r.text("Sorry, this is not a singular post/page template and therefore cannot store custom js, use master js instead.").attr("style","color: red;"),n.addClass("hidden")}),wp.customize.controlConstructor.code=wp.customize.Control.extend({ready:function(){var e=this,t=e.container.find("#kirki-codemirror-editor-"+e.id),i=CodeMirror.fromTextArea(t[0]),s={"Alt-F":"findPersistent"};i.setOption("value",e.setting._value),i.setOption("mode",e.params.choices.language),i.setOption("lineNumbers",!0),i.setOption("theme",e.params.choices.theme),i.setOption("height",e.params.choices.height+"px"),i.addKeyMap(s),i.on("change",function(){if(t.attr("id")=="kirki-codemirror-editor-icustomize-page-css-"+window.theme||t.attr("id")=="kirki-codemirror-editor-icustomize-page-js-"+window.theme){var s={postid:window.pid,theme:window.theme,data:i.getValue()};e.setting.set(s)}else e.setting.set(i.getValue())}),t.parents(".accordion-section").on("click",function(){i.refresh()})}}),e(document).ready(function(){function t(){n=e("#customize-preview"),d=e("#customize-preview iframe");var t,i,s=n.width();d.css("max-width")?(t=parseFloat(d.css("max-width")),i=.5*(s-t)):i=0,e("#preview-resize-left").css("left",i+"px")}var i,a,r=e(".wp-full-overlay.expanded"),c=e(".wp-full-overlay-sidebar"),n=e("#customize-preview"),d=e("#customize-preview iframe"),m=e("body [id^=customize-control-icustomize-master-css] .CodeMirror")[0].CodeMirror,l=e("body [id^=customize-control-icustomize-master-js] .CodeMirror")[0].CodeMirror,p=e("body [id^=customize-control-icustomize-page-css] .CodeMirror")[0].CodeMirror,u=e("body [id^=customize-control-icustomize-page-js] .CodeMirror")[0].CodeMirror,w=d.contents().find("#icustomize-master-css-"+window.theme),v=d.contents().find("#icustomize-master-js"+window.theme);e("#customize-controls").append(s),e("#customize-controls").prepend('<div class="dragbar"></div>'),e("body").on("click",".control-editor-item i",function(i){i.stopPropagation(),d=e("#customize-preview iframe"),e(i.target).parent().hasClass("active")?e(i.target).parent().removeClass("active"):(e(".control-editor-item").removeClass("active"),e(i.target).not(".fa-desktop, .fa-laptop, .fa-tablet, .fa-mobile").parent().addClass("active")),e(i.target).hasClass("editor")||e(i.target).hasClass("preview")||(e(i.target).hasClass("fa-desktop")?(d.css({"max-width":""}),e(".preview-width input").val(""),e("#preview-resize-left").css("left","")):e(i.target).hasClass("fa-laptop")?(d.css({"max-width":"1239px"}),e(".preview-width input").val("1239"),t()):e(i.target).hasClass("fa-tablet")?(d.css({"max-width":"767px"}),e(".preview-width input").val("767"),t()):e(i.target).hasClass("fa-mobile")&&(d.css({"max-width":"479px"}),e(".preview-width input").val("479"),t()))}),e("body").on("change, keyup",".preview-width input",function(i){d=e("#customize-preview iframe"),o(function(){var s=e(i.target).val();s>="0"?(d.css({"max-width":s+"px"}),t()):(d.css({"max-width":""}),t())},500)}),e("body").on("change, keyup",".editor-width input",function(i){r=e(".wp-full-overlay.expanded"),c=e(".wp-full-overlay-sidebar"),o(function(){var s=e(i.target).val();s>="0"?(r.css({"margin-left":s+"px"}),c.css({width:s+"px"}),t()):(r.css({"margin-left":"600px"}),c.css({width:"600px"}),t())},500)}),e("body").on("click","#accordion-section-icustomize_master_css h3.accordion-section-title, #accordion-section-icustomize_master_js h3.accordion-section-title, #accordion-section-icustomize_page_css h3.accordion-section-title, #accordion-section-icustomize_page_js h3.accordion-section-title",function(s){r=e(".wp-full-overlay.expanded"),c=e(".wp-full-overlay-sidebar"),d=e("#customize-preview iframe"),e("#customize-footer-actions").css("height","auto").find(".devices").addClass("hidden"),i=d.contents().find("#icustomize-page-css-"+window.theme),a=d.contents().find("#icustomize-page-js-"+window.theme),o(function(){if(e("body").addClass("icustomize-active"),e(".editor-width input").val()>="0"){var s=e(".editor-width input").val();r.css({"margin-left":s+"px"}),c.css({width:s+"px"}),t()}else r.css({"margin-left":"600px"}),c.css({width:"600px"}),e(".editor-width input").val("600"),t();if(e(".preview-width input").val()>="0"){var o=e(".preview-width input").val();d.css({"max-width":o+"px"}),t()}else d.css({"max-width":""}),e(".preview-width input").val(d.width()),t();w=d.contents().find("#icustomize-master-css-"+window.theme),v=d.contents().find("#icustomize-master-js-"+window.theme),w.length||d.contents().find("head").append('<style id="icustomize-master-css-'+window.theme+'">'),v.length||d.contents().find("body").append('<script id="icustomize-master-js-'+window.theme+'">');var n=i.html();n?p.setValue(n.replace(/^\s+|\s+$/g,"")):(p.setValue(""),i.length||d.contents().find("#icustomize-master-css-"+window.theme).after('<style id="icustomize-page-css-'+window.theme+'">'));var m=a.html();m?u.setValue(m.replace(/^\s+|\s+$/g,"")):(u.setValue(""),a.length||d.contents().find("#icustomize-master-js-"+window.theme).after('<script type="text/javascript" id="icustomize-page-js-'+window.theme+'">'))},100)}),e("body").on("click","#accordion-section-icustomize_master_css .customize-section-back, #accordion-section-icustomize_master_js .customize-section-back, #accordion-section-icustomize_page_css .customize-section-back, #accordion-section-icustomize_page_js .customize-section-back",function(t){r=e(".wp-full-overlay.expanded"),c=e(".wp-full-overlay-sidebar"),e("#customize-footer-actions").css("height","").find(".devices").removeClass("hidden"),e("body").removeClass("icustomize-active"),r.css({"margin-left":""}),c.css({width:""})}),m.on("change",function(t,i){d=e("#customize-preview iframe"),w=d.contents().find("#icustomize-master-css-"+window.theme),o(function(){w.html(t.getValue())},2e3)}),l.on("change",function(t,i){d=e("#customize-preview iframe"),d.contents().find("#icustomize-master-js-"+window.theme).remove(),o(function(){d.contents().find("#icustomize-page-js-"+window.theme).before('<script type="text/javascript" id="icustomize-master-js-'+window.theme+'">'+t.getValue()+"</script>")},2e3)}),p.on("change",function(t,s){d=e("#customize-preview iframe"),i=d.contents().find("#icustomize-page-css-"+window.theme),o(function(){i.html(t.getValue())},2e3)}),u.on("change",function(t,i){d=e("#customize-preview iframe"),d.contents().find("#icustomize-page-js-"+window.theme).remove(),o(function(){d.contents().find("#icustomize-master-js-"+window.theme).after('<script type="text/javascript" id="icustomize-page-js-'+window.theme+'">'+t.getValue()+"</script>")},2e3)}),e("#customize-controls .dragbar").on("mousedown",function(t){t.preventDefault(),r=e(".wp-full-overlay.expanded"),c=e(".wp-full-overlay-sidebar"),r.prepend('<div id="draghelper"></div>'),e(document).on("mousemove",function(t){t.pageX>=300&&e(window).width()-t.pageX>=200&&(r.css("margin-left",t.pageX),c.css("width",t.pageX),e(".editor-width").addClass("active dragging"),e(".editor-width input").val(t.pageX))})}),e(document).on("mouseup",function(){d=e("#customize-preview iframe"),e(document).unbind("mousemove"),e("#draghelper").remove(),d.css("pointer-events",""),e(".editor-width, .preview-width").hasClass("dragging")?e("#preview-resize-left, .editor-width, .preview-width").removeClass("active dragging"):e("#preview-resize-left").removeClass("active"),t()}),n.prepend('<div id="preview-resize-left"></div>'),t(),e("#preview-resize-left").on("mousedown",function(t){t.preventDefault(),n=e("#customize-preview"),d=e("#customize-preview iframe");var i=e("#preview-resize-left");e(document).on("mousemove",function(t){if(d.css("max-width")){i.addClass("active"),d.css("pointer-events","none");var s=n.width();if(i.css("left",t.offsetX+"px"),t.offsetX<100);else if(2*t.offsetX<s-200){var o=s-2*t.offsetX;d.css("max-width",o+"px"),e(".preview-width").addClass("active dragging"),e(".preview-width input").val(o)}else d.css("max-width","100px"),e(".preview-width input").val("100")}})})})}(jQuery,wp.customize);